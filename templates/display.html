<html>
    <link href="/assets/waiter.css" rel="stylesheet">
    <link href="/bower_components/bootswatch-dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
    <link href="/bower_components/datatables.net-responsive-bs/css/responsive.bootstrap.min.css" rel="stylesheet">

    <head>
        <link rel="shortcut icon" type="image/png" href="/assets/favicon.ico"/>
        {% if title %}
        <title>Alfred - {{title}}</title>
        {% else %}
        <title>Alfred v1.0</title>
        {% endif %}

        <div class="container container-header">
            {% if title %}
            <h1>Alfred - {{title}}</h1>
            {% else %}
            <h1>Alfred v1.0</h1>
            {% endif %}
        </div>
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
        {% block navbar%}
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="/mediaviewer/">MediaViewer</a>
            </div>
            <div class="navbar-collapse collapse">
            {% if loggedin %}
                <ul class="nav navbar-nav">
                    {{ header }}
                    {% if loggedin %}
                        <li class="navbar-right"><a href="/mediaviewer/logout/">Log out</a></li>
                    {% else %}
                        <li class="navbar-right"><a href="/mediaviewer/login/">Log In</a></li>
                    {% endif %}
                </ul>
                {% if loggedin %}
                    <p class="navbar-text navbar-right">Signed in as <a href="/mediaviewer/settings/" class="navbar-link">{{ user.username }}</a></p>
                {% endif %}
            {% else %}
                <ul class="nav navbar-nav">
                    <li class="navbar-right"><a href="/mediaviewer/login/">Log In</a></li>
                </ul>
            {% endif %}
            </div><!--/.nav-collapse -->
          </div>
        {% endblock %}
        </div>

        <div class="container">
            <div class="well">
                <h4 class="top-message">
                    Follow the links below for streaming
                </h4>
            </div>
            <table id="myTable" class="table table-hover dt-responsive">
                <thead>
                    <tr>
                        <th class="all">Filename</th>
                        {% if not files.0.ismovie and auto_download %}
                            <th class="desktop">Streaming</th>
                            <th class="all">Autodownload</th>
                            <th class="min-tablet-p">Cancel</th>
                        {% else %}
                            <th class="all">Streaming</th>
                        {% endif %}
                        <th class="desktop">Size</th>
                        <th class="desktop">Is Alfred Encoded?</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                {% for file in files %}
                <tr>
                    <!-- <td><a class="link" href="{{ file.streamingPath }}">{{ file.filename }}</a></td> -->
                    <td><a class="link" href="#" onclick='cancelClick(this); window.open("{{ file.streamingPath }}", "_blank", "height=600, width=800, resizeable=yes")'>{{ file.filename }}</a></td>
                    {% if file.streamable %}
                    <td>
                        <a class='btn btn-info' name='streaming-btn' id='streaming-btn' onclick='cancelClick(this); window.open("{{ file.streamingPath }}", "_blank", "height=600, width=800, resizeable=yes")'>Stream It!</a>
                    </td>
                    {% else %}
                    <td>
                        Not Streamable
                    </td>
                    {% endif %}
                    {% if not file.ismovie and auto_download %}
                    <td class="autodownloadtext">
                        <span id="countdown" class="timer" onclick="cancelClick(document.getElementById('cancel-btn'))"></span>
                    </td>
                    <td>
                        <a class='btn btn-info' name='cancel-btn' id='cancel-btn' onclick='cancelClick(this)'>Stop Download</a>
                    </td>
                    {% endif %}
                    <td>{{file.size}}</td>
                    {% if file.isAlfredEncoding %}
                        <td>Yes</td>
                    {% else %}
                        <td>No</td>
                    {% endif %}
                    <td></td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </body>
    <div class="hiddenframe">
        <iframe id="download" width="1" height="1" frameborder="0"></iframe>
    </div>
</html>
<script src="/bower_components/jquery/dist/jquery.min.js"></script>
<script src="/bower_components/datatables.net/js/jquery.dataTables.min.js" %}"></script>
<script src="/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js" %}"></script>
<script src="/bower_components/datatables.net-responsive/js/dataTables.responsive.min.js" %}"></script>
<script src="/bower_components/bootstrap/dist/js/bootstrap.min.js" %}"></script>
<script src="/assets/waiter_v2.js"></script>
<script>
    $(document).ready(function (){
        prepareDataTable($);
        {% if not files.0.ismovie and auto_download %}
            filePath = "{{files.0.path}}";
            setupAutoDownloadCountdown();
        {% endif %}
    });
</script>
